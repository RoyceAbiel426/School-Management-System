# Export & Reports - Quick Reference Guide

## üìö Quick Start

### Import Statements

```jsx
// Export utilities
import {
  exportToCSV,
  exportToExcel,
  exportToPDF,
  printElement,
  exportCustomReport,
} from "../utils/exportHelpers";

// Report templates
import {
  studentListReportTemplate,
  attendanceReportTemplate,
  getReportTemplate,
} from "../utils/exportHelpers";

// Components
import { ExportButton, ReportBuilder } from "../components/export";
```

---

## üîß Common Use Cases

### 1. Add Export to a List Page

```jsx
<ExportButton
  data={items}
  columns={[
    { header: "ID", key: "id" },
    { header: "Name", key: "name" },
    { header: "Email", key: "email" },
  ]}
  filename="my_export"
  title="My Report"
/>
```

### 2. Export to Specific Format

```jsx
// CSV
exportToCSV(data, "filename", columns);

// Excel
exportToExcel(data, "filename", columns, "SheetName");

// PDF
exportToPDF(data, "filename", columns, {
  title: "My Report",
  orientation: "landscape",
  metadata: { generatedBy: "Admin" },
});
```

### 3. Use Pre-configured Template

```jsx
const template = getReportTemplate("attendance");

<ExportButton
  data={attendanceData}
  columns={template.columns}
  filename="attendance_report"
  title={template.title}
  orientation={template.orientation}
/>;
```

### 4. Add Report Builder to Dashboard

```jsx
const [showReports, setShowReports] = useState(false);

<Button onClick={() => setShowReports(true)}>
  Generate Report
</Button>

<ReportBuilder
  isOpen={showReports}
  onClose={() => setShowReports(false)}
/>
```

### 5. Print Current View

```jsx
// Method 1: Print specific element
<button onClick={() => printElement('printable-content')}>
  Print
</button>

<div id="printable-content">
  {/* Content to print */}
</div>

// Method 2: Print entire page
<button onClick={() => window.print()}>
  Print Page
</button>
```

---

## üìã Column Definition

```jsx
const columns = [
  {
    header: "Student ID", // Column header text
    key: "studentId", // Data object key
    type: "text", // Optional: 'text', 'date', 'number'
  },
  {
    header: "Name",
    key: "name",
  },
  {
    header: "Enrollment Date",
    key: "enrollmentDate",
    type: "date", // Auto-formats dates
  },
];
```

---

## üé® ExportButton Props

```jsx
<ExportButton
  // Required
  data={[]}                      // Array of objects
  columns={[]}                   // Column definitions
  filename="export"              // Filename (no extension)

  // Optional
  title="Report Title"           // Report title
  metadata={{ ... }}             // Additional metadata
  formats={['csv','excel','pdf']} // Allowed formats
  orientation="portrait"         // 'portrait' | 'landscape'
  pageSize="a4"                  // 'a4' | 'letter'
  printElementId="content"       // Element ID for print
  onExport={(format) => {}}      // Callback after export
  variant="primary"              // Button variant
  size="md"                      // Button size
  className=""                   // Additional CSS
/>
```

---

## üèóÔ∏è Report Templates

### Available Templates

| Template ID           | Name                 | Category       |
| --------------------- | -------------------- | -------------- |
| `attendance`          | Attendance Report    | Academic       |
| `results`             | Results Report       | Academic       |
| `studentList`         | Student List         | Administration |
| `teacherList`         | Teacher List         | Administration |
| `libraryBooks`        | Library Books        | Library        |
| `libraryTransactions` | Library Transactions | Library        |
| `sportsParticipants`  | Sports Participants  | Sports         |
| `courseEnrollment`    | Course Enrollment    | Academic       |
| `monthlyAttendance`   | Monthly Attendance   | Academic       |
| `examSchedule`        | Exam Schedule        | Academic       |
| `overdueBooks`        | Overdue Books        | Library        |

### Use a Template

```jsx
import { getReportTemplate } from "../utils/exportHelpers";

const template = getReportTemplate("studentList");
// Returns: { title, columns, orientation, pageSize }

exportToPDF(data, "students", template.columns, {
  title: template.title,
  orientation: template.orientation,
});
```

---

## üéØ Custom Report Export

```jsx
import { exportCustomReport } from "../utils/exportHelpers";

exportCustomReport({
  title: "Monthly Attendance Report",
  subtitle: "November 2025",
  data: attendanceData,
  columns: [
    { header: "Student", key: "name" },
    { header: "Present", key: "present" },
  ],
  filename: "attendance_nov_2025",
  format: "pdf", // 'pdf' | 'excel' | 'csv'
  summary: {
    "Total Students": 1200,
    "Average Attendance": "94.5%",
  },
  footer: "Generated by Edu-Pro System",
});
```

---

## üìÑ Multiple Sheet Export

```jsx
import { exportMultipleSheetsToExcel } from "../utils/exportHelpers";

exportMultipleSheetsToExcel(
  [
    {
      data: students,
      columns: studentColumns,
      sheetName: "Students",
    },
    {
      data: teachers,
      columns: teacherColumns,
      sheetName: "Teachers",
    },
  ],
  "school_report"
);
```

---

## üñ®Ô∏è Print Optimization

### Add Print Classes

```jsx
<div className="print-only">
  {/* Shows only when printing */}
  <h1>Printed Report</h1>
</div>

<button className="no-print">
  {/* Hidden when printing */}
  Export
</button>

<div className="page-break">
  {/* Forces page break before */}
</div>

<table className="avoid-break">
  {/* Prevents breaking inside */}
</table>
```

---

## üö® Error Handling

```jsx
try {
  exportToPDF(data, filename, columns);
} catch (error) {
  console.error("Export failed:", error);
  alert("Failed to export. Please try again.");
}
```

All export functions include built-in error handling and user-friendly alerts.

---

## üí° Tips & Best Practices

### 1. Data Transformation

Transform your data before exporting:

```jsx
const exportData = students.map((s) => ({
  studentId: s.studentId,
  name: s.name,
  grade: s.grade,
  class: s.class?.name || "Not assigned", // Handle nulls
  enrollmentDate: s.enrollmentDate,
}));
```

### 2. Date Formatting

Use `type: 'date'` in columns for auto-formatting:

```jsx
{ header: 'Date', key: 'date', type: 'date' }
```

### 3. Large Datasets

For large datasets, consider:

- Pagination before export
- Background processing
- Progress indicators

### 4. Filename Convention

```jsx
const filename = `students_${new Date().toISOString().split("T")[0]}`;
// Result: students_2025-11-26
```

### 5. Metadata

Include useful metadata:

```jsx
metadata: {
  generatedBy: user?.name || 'Admin',
  generatedAt: new Date(),
  schoolName: school?.name,
  reportId: `RPT-${Date.now()}`
}
```

---

## üì± Responsive Export Button

```jsx
<div className="hidden md:block">
  <ExportButton {...props} />
</div>

<div className="md:hidden">
  <Button onClick={() => setShowExportModal(true)}>
    Export
  </Button>
</div>
```

---

## üîç Debugging

### Check Data

```javascript
console.log("Export data:", data);
console.log("Columns:", columns);
```

### Verify Downloads

- Check browser download folder
- Ensure popup blockers disabled
- Verify file permissions

### Common Issues

| Issue                  | Solution                   |
| ---------------------- | -------------------------- |
| Empty PDF              | Check data array not empty |
| CSV encoding           | Ensure UTF-8 support       |
| Excel won't open       | Verify data structure      |
| Print shows navigation | Add `no-print` class       |

---

## üìö Additional Resources

- [PHASE_3.5_COMPLETE.md](./PHASE_3.5_COMPLETE.md) - Full documentation
- [jsPDF Docs](https://github.com/parallax/jsPDF) - PDF library
- [xlsx Docs](https://github.com/SheetJS/sheetjs) - Excel library

---

_Last Updated: November 26, 2025_
